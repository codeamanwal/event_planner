<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>SIGNUP</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js" integrity="sha512-E8QSvWZ0eCLGk4km3hxSsNmGWbLtSCSUcewDQPQWZF6pEU8GlT8a5fF32wOl1i8ftdMhssTrF/OhyGWwonTcXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <style>
          *{
            padding: 0;
            margin: 0;
            box-sizing:border-box;
          }
          body{
            background: rgb(219,226,226)
          }
          .row{
            background : white;
            border-radius: 30px;
            box-shadow: 12px 12px 22px grey;
          }
          img{
            border-top-left-radius: 30px;
            border-bottom-left-radius: 30px;
            height: 710px;
            width: 490px;
          }
          .btn1{
            border: none;
            outline:none;
            height: 50px;
            width: 100%;
            background-color: black;
            color: white;
            border-radius: 4px;
            font-weight: bold;
          }
          .btn1:hover{
            background: white;
            border: 1px solid;
            color: black;
          }
    </style>

  </head>
  <body>
    <section class="Form my-4 mx-5">
      <div class="container">
        <div class="row no-gutters">
          <div class="col-lg-5">
            <img class= "py-3" src="https://cdn.siasat.com/wp-content/uploads/2019/09/event.jpg" class="img-fluid" alt="">

          </div>
          <div class="col-lg-7 px-5 pt-5">
            <h1 class="font-weight-bold py-3"><b>EVENT PLANNER</b></h1>
            <h4>Sign Up into your account</h4>
            <form>
              <div class="form-row">
                <div class="col-lg-7">
                  <input type="text" placeholder="First Name" id="Fname" class="form-control my-3 p-4">
                </div>
              </div>
              <div class="form-row">
                <div class="col-lg-7">
                  <input type="text" placeholder="Last Name" id="Lname" class="form-control my-3 p-4">
                </div>
              </div>

              <div class="form-row">
                <div class="col-lg-7">
                  <input type="email" placeholder="Email Address" id="email" class="form-control my-3 p-4">
                </div>
              </div>
              <div class="form-row">
                <div class="col-lg-7">
                  <input type="tel" placeholder="Phone Number" id="PhNo" class="form-control my-3 p-4">
                </div>
              </div>

              <div class="form-row">
                <div class="col-lg-7">
                  <input type="password" placeholder="********" id="password" class="form-control my-3 p-4">
                </div>
              </div>
              <div class="form-row">
                <div class="col-lg-7">
                  <button type="button" id= "sub_btn" class="btn1 mt-3 mb-2">Sign Up</button>
                </div>
              </div>
              <a href="SignIn.html" class="my-5 p-4 mb-4">Already have an account?</a>

            </form>

          </div>

        </div>

      </div>s

    </section>
    <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.11/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.6.11/firebase-analytics.js";

  const firebaseConfig = {
    apiKey: "AIzaSyABxKoaMeyjWnobZ4603V1bPceC8MPnJ08",
    authDomain: "eventp-c8d20.firebaseapp.com",
    databaseURL: "https://eventp-c8d20-default-rtdb.firebaseio.com",
    projectId: "eventp-c8d20",
    storageBucket: "eventp-c8d20.appspot.com",
    messagingSenderId: "237275657082",
    appId: "1:237275657082:web:dc6c90ef82e69fb84e5cc3",
    measurementId: "G-X8BH9NV37E"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
  import{getDatabase, ref, set, child, get}
     from "https://www.gstatic.com/firebasejs/9.6.11/firebase-database.js";
  const db = getDatabase();

  const email = document.getElementById("email");
  const password = document.getElementById("password");
  const first_name = document.getElementById("Fname");
  const last_name = document.getElementById("Lname");
  const phone = document.getElementById("PhNo");
  const signup = document.getElementById('sub_btn');

  function Validation(){
    let fnameregex = /^[a-zA-Z]+$/;
    let lnameregex = /^[a-zA-Z]+$/;
    let emailregex= /^[a-zA-Z0-9]+@(gmail|yahoo|outlook)\.com$/;
    let phoneregex = /^[0-9]{10}$/;


    if (!fnameregex.test(first_name.value)){
      alert("Name should only contain alphabets");
      return false;
    }

    if (!lnameregex.test(last_name.value)){
      alert("Name should only contain alphabets");
      return false;
    }

    if (!emailregex.test(email.value)){
      alert("Enter a valid email");
      return false;
    }

    if (!phoneregex.test(phone.value)){
      alert("Please enter valid phone number");
      return false;
    }
    return true;
  }

  function RegisterUser(){
    if (!Validation()){
      return;
    };
    const dbRef = ref(db);
    get(child(dbRef,"UsersList/"+ email.value)).then((snapshot)=>{
      if(snapshot.exists()){
        alert("Account already exists!")
      }
      else{
        set(ref(db, "UsersList/"+email.value),
        {
          firstname: first_name.value,
          lastname: last_name.value,
          email: email.value,
          phone: phone.value,
          password: password.value
        })
        .then(()=>{
          alert("User added successfully!!");
        })
        .catch((error)=>{
          alert("error"+error);
        })
      }
    });
  }

     signup.addEventListener('click',RegisterUser);
   </script>

  </body>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

</html>
